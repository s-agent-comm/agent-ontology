@prefix tm: <https://w3id.org/agent-ontology/threat-model#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix core: <https://w3id.org/agent-ontology/core#> .
@prefix dcterms: <http://purl.org/dc/terms/> .

#################################################################
# Ontology Header
#################################################################

<https://w3id.org/agent-ontology/threat-model>
  dcterms:title "Threat Model Ontology" ;
  dcterms:license <https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document> ;
  dcterms:rightsHolder "Semantic Agent Communication Community Group" ;
  dcterms:creator "Tyson Chen (SlashLife AI)" ;
  dcterms:description "Ontology for minimal semantic interoperability and threat modeling among AI Agents." ;
  dcterms:modified "2025-11-17"^^xsd:date ;
  owl:versionInfo "0.1.0" .

#################################################################
# Core Classes
#################################################################

# Agent Identity
tm:Agent a owl:Class ;
    rdfs:label "Agent" ;
    rdfs:comment "An autonomous computational entity capable of semantic communication." .

# Capability (to prevent Capability Misrepresentation)
tm:Capability a owl:Class ;
    rdfs:label "Capability" ;
    rdfs:comment "A functional ability that an Agent claims or possesses." .

# Task (corresponds to Task Graph)
tm:Task a owl:Class ;
    rdfs:label "Task" ;
    rdfs:comment "A well-defined action unit exchanged between Agents." .

# Intent (basis for Intent Ambiguity Threat)
tm:Intent a owl:Class ;
    rdfs:label "Intent" ;
    rdfs:comment "A purpose or goal communicated by an Agent." .

# Essential elements for Task DAG structure
tm:TaskNode a owl:Class ;
    rdfs:label "TaskNode" ;
    rdfs:comment "Node in a task dependency graph." .

tm:TaskDependency a owl:Class ;
    rdfs:label "TaskDependency" ;
    rdfs:comment "Dependency relation in a task graph." .

# Delegation (Delegation Threat)
tm:Delegation a owl:Class ;
    rdfs:label "Delegation" ;
    rdfs:comment "An assignment of authority or responsibility between Agents." .

#################################################################
# Object Properties
#################################################################

# Basic association between Agent and Capability
tm:hasCapability a owl:ObjectProperty ;
    rdfs:label "hasCapability" ;
    rdfs:domain tm:Agent ;
    rdfs:range tm:Capability ;
    rdfs:comment "Declares that an Agent possesses a specific Capability." .

tm:requiresCapability a owl:ObjectProperty ;
    rdfs:label "requiresCapability" ;
    rdfs:domain tm:Task ;
    rdfs:range tm:Capability ;
    rdfs:comment "Declares that a Task requires a specific Capability." .

# Agent Behavior
tm:expressesIntent a owl:ObjectProperty ;
    rdfs:label "expressesIntent" ;
    rdfs:domain tm:Agent ;
    rdfs:range tm:Intent ;
    rdfs:comment "An Agent expresses a certain Intent." .

tm:performsTask a owl:ObjectProperty ;
    rdfs:label "performsTask" ;
    rdfs:domain tm:Agent ;
    rdfs:range tm:Task ;
    rdfs:comment "An Agent performs a given Task." .

# Task Graph
tm:hasSubtask a owl:ObjectProperty ;
    rdfs:label "hasSubtask" ;
    rdfs:domain tm:Task ;
    rdfs:range tm:Task ;
    rdfs:comment "Represents hierarchical task decomposition." .

tm:hasDependency a owl:ObjectProperty ;
    rdfs:label "hasDependency" ;
    rdfs:domain tm:TaskNode ;
    rdfs:range tm:TaskNode ;
    rdfs:comment "Represents a dependency between task nodes." .

# Delegation
tm:delegatedTo a owl:ObjectProperty ;
    rdfs:label "delegatedTo" ;
    rdfs:domain tm:Delegation ;
    rdfs:range tm:Agent ;
    rdfs:comment "Specifies the Agent to whom a task or authority is delegated." .

tm:delegatedFrom a owl:ObjectProperty ;
    rdfs:label "delegatedFrom" ;
    rdfs:domain tm:Delegation ;
    rdfs:range tm:Agent ;
    rdfs:comment "Specifies the Agent delegating a task or authority." .

tm:delegatesTask a owl:ObjectProperty ;
    rdfs:label "delegatesTask" ;
    rdfs:domain tm:Agent ;
    rdfs:range tm:Task ;
    rdfs:comment "An Agent delegates a specific Task to another Agent." .

#################################################################
# Axioms for Threat Detection (Minimal)
#################################################################

# Consistency between Capability and Task (prevents Capability Misrepresentation)
tm:hasCapability rdfs:subPropertyOf tm:requiresCapability .

# Agents cannot claim contradictory capabilities (Minimal Disjoint Axiom)
tm:CriticalCapability a owl:Class ;
    owl:disjointWith tm:RestrictedCapability .

# Semantic consistency between Intent and Task
tm:IntentAlignsWithTask a owl:ObjectProperty ;
    rdfs:label "IntentAlignsWithTask" ;
    rdfs:domain tm:Intent ;
    rdfs:range tm:Task ;
    rdfs:comment "Links expressed Intent to the Task it authorizes or motivates." .

#################################################################
# Example Individuals (Optional)
#################################################################

tm:exampleAgent a tm:Agent ;
    tm:hasCapability tm:exampleCapability .

tm:exampleCapability a tm:Capability .

tm:taskA a tm:Task ;
    tm:requiresCapability tm:exampleCapability .
